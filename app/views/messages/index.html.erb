<h2 class="discussion-header">Mes messages</h2>

<% awaiting_messages = @awaiting_messages  %>
<% if awaiting_messages.any? %>
  <div class="messages-list">
    <% awaiting_messages.each do |message| %>
      <% next if message.nil? || message.id.nil? %>
      <div class="card-mobile position-relative mb-3">
        <%= button_to dismiss_suggestion_message_path(message), method: :patch, class: "btn-close-alert", title: "Ignorer cette suggestion" do %>
          <i class="bi bi-x-lg"></i>
        <% end %>
        <div class="message-author"><strong>De :</strong> <%= message.contact.name %></div>
        <div class="message-content"><%= message.content %></div>
        <div class="suggestion">
          <%= message.ai_draft.presence || "Aucune suggestion disponible." %>
        </div>
        <div class="message-actions">
          <%= link_to "Rekonect", reply_message_path(message), class: "btn btn-rekonect" %>
          <%= link_to "Conversation", conversation_path(message.conversation), class: "btn btn-conversation" %>
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <div class="alert-mobile mt-4">Aucun message en attente de rÃ©ponse.</div>
<% end %>
<%= render "shared/navbar_bottom" %>

<h2 class="discussion-header">Mes conversations</h2>
<div class="contacts-list">
  <% @conversations.each do |conversation| %>
  <div class="reply-container">
    <%= link_to conversation_path(conversation), class: "contact-card" do %>
      <div class="contact-avatar">
        <% if conversation.contact.photo.attached? %>
          <%= image_tag conversation.contact.photo, class: "avatar-img" %>
        <% else %>
          <%= image_tag "default-avatar.png", class: "avatar-img" %>
        <% end %>
      </div>
      <div class="contact-name"><%= conversation.contact.name %></div>
    <% end %>
  <% end %>
</div>
