<h2 class="circles-header">Gestion des cercles de contact</h2>

<%= form_with url: contacts_path, method: :put, local: true do %>
  <div class="contacts-list">
    <% @contacts.each do |contact| %>
      <div class="contact-card-container">
        <%= link_to contact_path(contact), class: "contact-card" do %>
          <div class="contact-avatar">
            <% if contact.photo.attached? %>
              <%= image_tag contact.photo, class: "avatar-img", alt: contact.name %>
            <% else %>
              <%= image_tag "default-avatar.png", class: "avatar-img", alt: contact.name %>
            <% end %>
          </div>
          <div class="contact-name"><%= contact.name %></div>
        <% end %>

        <!-- Bandeau Inputs -->
        <div class="contact-circle-fields-card">
          <div class="contact-circle-fields">
            <label class="circle-label">Priorit√© :</label>
            <%= select_tag "contacts[#{contact.id}][priority]",
              options_for_select([
                ['üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Famille (parents/enfants)', 9],
                ['üëµ Grands-parents', 8],
                ['üë®‚Äç‚ù§Ô∏è‚Äçüë® Fr√®res / S≈ìurs', 7],
                ['üßë‚Äçü§ù‚Äçüßë Cousin¬∑e(s)', 6],
                ['üßî‚Äç‚ôÇÔ∏è Oncles / Tantes', 5],
                ['üíë Partenaire de vie', 4],
                ['üßí Neveu / Ni√®ce', 3],
                ['üíõ Ami¬∑e tr√®s proche', 2],
                ['ü§ù Connaissance / coll√®gue', 1],
                ['ü´• Autre / Distant', 0]
              ], contact.relationship&.proximity),
              class: "circle-select" %>

            <%= select_tag "contacts[#{contact.id}][reminder_days]",
              options_for_select([7, 14, 21, 30, 60, 90].map { |d| ["Rappel dans #{d} jours", d] }, selected: contact.notes&.to_i),
              class: "circle-select" %>
          </div>
        </div>
      </div> <!-- /.contact-card-container -->
    <% end %>
  </div> <!-- /.contacts-list -->

  <div class="circle-submit-container">
    <%= submit_tag "Enregistrer", class: "btn-save btn-pink circles-btn-submit" %>
  </div>
<% end %>

<%= render 'shared/navbar_bottom', active: 'contacts' %>
